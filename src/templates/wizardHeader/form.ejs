<nav aria-label="navigation" id="{{ ctx.wizardKey }}-header" class="fg-slate-65">
  <a href="{{ ctx.options.properties.backURL}}">{{ ctx.options.properties.backTitle}}</a>
  <ul class="list-style-none mb-3">
    {% ctx.panels.forEach(function(panel, index) { %}

    {% var completed = index < ctx.currentPage; %}
    {% var active = index === ctx.currentPage; %}

    {% if (!panel.properties.hideFromNavigation || panel.properties.hideFromNavigation !== "true") { %}

    <li class="d-flex flex-items-center" {% if (active) { %} aria-current="page" {% } %}>

      {% if (active) { %}
      <span data-icon="square" class="pr-1 fg-slate"></span>
      {% } %}

      {% var color = active || completed ? "fg-slate" : ""  %}
      {% var style = active ? "fw-medium" : completed ? "u" : "" %}


      <span class="flex-auto py-1 {{ color }} {{ style }}" {% if (completed || ctx.options.unlockNavigation) { %}
        ref="{{ ctx.wizardKey }}-link" {% } %}>
        {{ ctx.t(panel.properties.displayTitle || panel.title) }}
      </span>
    </li>

    {% } else { // if we don't render something, the nav indexes are wrong and nav clicks go to the wrong place %}
    <span ref="{{ ctx.wizardKey }}-link"></span>
    {% } %}

    {% }) %}
  </ul>
</nav>